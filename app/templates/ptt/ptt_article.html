<!DOCTYPE html>
<html lang="en" dir="ltr">
    <head>
        <meta charset="utf-8">
        {% set article_index = namespace(value=1) %}
        {% for article in ptt_article %}
        <meta id="ptt-article-{{ article_index.value }}" data-content="{{ article.content }}">
        {% set article_index.value = article_index.value + 1 %}
        {% endfor %}
        <title>PTT新文章 - NN's Site</title>
    </head>
    <body>
        {% extends "base.html" %}
        {% block breadcrumb %}
        <li class="breadcrumb-item active"><a href="{{ url_for('main.index') }}">Home</a></li>
        <li class="breadcrumb-item"><a href="{{ url_for('ptt.index') }}">PTT</a></li>
        <li class="breadcrumb-item active" aria-current="page">PTT新文章</li>
        {% endblock %}
        {% block content %}
        <table class="table table-striped table-bordered ptt-article-table">
            <thead>
                <tr>
                    <th scope="col" style="width: 42px;">No.</th>
                    <th scope="col" style="width: 160px;">時間</th>
                    <th scope="col" style="width: 111px;">看板</th>
                    <th scope="col" style="width: 107px;">作者</th>
                    <th scope="col" style="width: 500px;">標題</th>
                    <th scope="col" style="width: 350px;">內文</th>
                </tr>
            </thead>
            <tbody>
                {% set article_index = namespace(value=1) %}
                {% for article in ptt_article %}
                <tr id="ptt-article-{{ article_index.value }}-row" class="ptt-article-row" onclick="show_article_content({{ article_index.value }})">
                    <td>{{ article_index.value }}</td>
                    <td>{{ article.published }}</td>
                    <td>{{ article.board }}</td>
                    <td>{{ article.author }}</td>
                    <td><a href="{{ article.link }}">{{ article.title }}</a></td>
                    {% if article_index.value == 1 %}
                    <td rowspan="{{ ptt_article.per_page }}" id="ptt-article-content" class="ptt-article-table ptt-article-content">{{ article.content }}</td>
                    {% endif %}
                </tr>
                {% set article_index.value = article_index.value + 1 %}
                {% endfor %}
            </tbody>
        </table>
        <nav aria-label="Page navigation example">
            <ul class="pagination justify-content-center">
                {% if ptt_article.has_prev %}
                <li class="page-item"><a class="page-link" href="?page={{ ptt_article.prev_num }}&per_page={{ ptt_article.per_page }}">Previous</a></li>
                {% else %}
                <li class="page-item disabled"><a class="page-link" href="#">Previous</a></li>
                {% endif %}
                {% for num in ptt_article.iter_pages() %}
                {% if num %}
                {% if num == ptt_article.page %}
                <li class="page-item active"><a class="page-link" href="#">{{ num }}</a></li>
                {% else %}
                <li class="page-item"><a class="page-link" href="?page={{ num }}&per_page={{ ptt_article.per_page }}">{{ num }}</a></li>
                {% endif %}
                {% else %}
                <li class="page-item disabled"><a class="page-link" href="#">{{ '...' }}</a></li>
                {% endif %}
                {% endfor %}
                {% if ptt_article.has_next %}
                <li class="page-item"><a class="page-link" href="?page={{ ptt_article.next_num }}&per_page={{ ptt_article.per_page }}">Next</a></li>
                {% else %}
                <li class="page-item disabled"><a class="page-link" href="#">Next</a></li>
                {% endif %}
            </ul>
        </nav>
        <script type="text/javascript">
            function show_article_content(index){
                $('#ptt-article-content')[0].innerHTML = $('#ptt-article-'+index).data('content')
            }
        </script>
        {% endblock %}
    </body>
</html>